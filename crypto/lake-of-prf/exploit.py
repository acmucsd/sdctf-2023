import binascii
import pwn

p = pwn.process("game.py") # replace this with pwn.remote("hostname", port)

def complement(hexstr):
    hexstr_bytes = binascii.unhexlify(hexstr)
    hexstr_bytes_comp = bytes(x ^ 0xff for x in hexstr_bytes)
    hexstr_comp = binascii.hexlify(hexstr_bytes_comp)
    return hexstr_comp

for i in range(50):
    p.recvuntil(b"Enter a number: ")
    p.sendline(b"3")
    p.recvuntil(b"utter: ")
    p.sendline(b"a" * 32)
    p.recvuntil(b"The left door sings: ")
    left_response_1 = p.recvline().strip()
    p.recvuntil(b"Enter a number: ")
    p.sendline(b"3")
    p.recvuntil(b"utter: ")
    p.sendline(complement(left_response_1.decode("utf-8")[:32]))
    p.recvuntil(b"The left door sings: ")
    left_response_2 = p.recvline().strip()
    p.recvuntil(b"Enter a number: ")
    if (left_response_2[32:] == b"a" * 32):
        p.sendline(b"2") # left door is pseudorandom, meaning the right door is random
    else:
        p.sendline(b"1")

p.interactive()
